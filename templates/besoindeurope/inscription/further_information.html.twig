{% extends 'besoindeurope/inscription/_layout.html.twig' %}

{% block page_title 'Informations complémentaires' %}

{% form_theme form 'renaissance/forms/tailwind_form_theme.html.twig' %}

{% block content_section %}
    <twig:Atoms:ReCard class="max-w-[500px]" x-data="xFurtherInformationForm({
        isElu: {{ (form.mandates.vars.value and form.mandates.vars.value|length ? 'true' : 'false')|e('js') }}
    })">
        {% include 'renaissance/partials/flashes.html.twig' with {slim: true} %}

        {{ form_start(form, { attr: { 'x-ref': 'form', class: 'flex gap-6 flex-col'} }) }}
            {{ form_errors(form) }}

            <p class="font-medium">Informations complémentaires</p>

            <fieldset>
                <twig:Molecules:ReCheckboxField id="is-elu" class="w-full" x-on:change="handleIsElu($event)">
                    <label for="is-elu">Je suis élu (optionnel)</label>
                </twig:Molecules:ReCheckboxField>
            </fieldset>

            <twig:ReParagraphStatus status="valid" x-show="isElu" x-cloak>
                En déclarant vos mandats ici, nous préviendrons votre
                <span class="font-medium">Président d’Assemblée départementale</span>
                qui pourra, le cas échéant, vous inclure dans les élus de Renaissance.
            </twig:ReParagraphStatus>

            <fieldset class="flex flex-col gap-2.5" x-show="isElu" x-cloak id="elu-form">
                {{ form_row(form.mandates) }}
            </fieldset>

            <p class="font-medium">Date de naissance</p>

            <fieldset class="relative max-h-[55px]">
                <fieldset class="flex gap-2.5 relative">
                    {{ form_widget(form.birthdate.day, {label: false, attr: {
                        class: "w-full",
                        placeholder: 'Jour',
                        validate: "['required']",
                        onCheck: "setFieldValid('birthDay')",
                        'x-on:change': "setDay($event.target.value)",
                        searchBoxProps: {'x-numberonly': ''}
                    }}) }}

                    {{ form_widget(form.birthdate.month, {label: false, attr: {
                        class: "w-full",
                        placeholder: 'Mois',
                        validate: "['required']",
                        onCheck: "setFieldValid('birthMonth')",
                        'x-on:change': "setMonth($event.target.value)",
                    }}) }}

                    {{ form_widget(form.birthdate.year, {label: false, attr: {
                        class: "w-full",
                        placeholder: 'Année',
                        validate: "['required']",
                        onCheck: "setFieldValid('birthYear')",
                        'x-on:change': "setYear($event.target.value)",
                        searchBoxProps: {'x-numberonly': ''}
                    }}) }}
                </fieldset>

                {{ form_errors(form.birthdate) }}
            </fieldset>

            <hr class="border-dashed">

            <p class="font-medium">Numéro de téléphone</p>

            <fieldset>
                {{ form_row(form.phone, {label: false }) }}
            </fieldset>

            {{ form_row(form.acceptSmsNotification, {label: "Je souhaite recevoir les informations sur l'actualité de Renaissance et ses communications politiques par SMS et téléphone"}) }}

            <twig:ReButton
                color="black"
                class="w-full"
                loading="x:loading"
                x-on:click="handleSubmit($event)"
                x-bind:class="{disabled: !checkValidity()}"
            >Valider</twig:ReButton>
        {{ form_end(form) }}
    </twig:Atoms:ReCard>
{% endblock %}

{% block final_javascripts %}
    <script>
        Bootstrap.onLoad(() => Main.runAdhesionFurtherInformationPage());
    </script>
{% endblock %}

<div class="l__row l__row--h-stretch l__row--wrap">
    <h1 class="text--medium-large">Mes dons</h1>
    {% if donations_history is not empty %}
    <a href="{{ path('app_donation_index') }}" class="btn btn--red b__nudge--bottom-larger">Faire un nouveau don</a>
    {% endif %}
</div>

{% if donations_history is not empty %}
    <p class="text--body">Merci pour votre engagement à nos côtés !</p>
    <p class="text--body text--bold">Votre dernier don remonte à {{ donations_history|first.date|format_datetime('none', 'none', 'd MMMM yyyy') }}.</p>
    {% if subscribed_donations %}
    <p class="text--body">
        {% for subscribed_donation in subscribed_donations %}
            Prochaine échéance du don mensuel de {{ subscribed_donation.amountInEuros }}€ le {{ subscribed_donation.nextDonationAt|format_datetime('medium', 'none') }}
            {% if not loop.last %}
                <br />
            {% endif %}
        {% endfor %}
    {% elseif last_subscription_ended %}
        Vous avez mis fin à votre don mensuel le {{ last_subscription_ended.subscriptionEndedAt|format_datetime('medium', 'none') }}. Vous pouvez en refaire un <a href="{{ path('app_donation_index') }}">en cliquant ici</a>.
    {% else %}
        <a href="{{ path('app_donation_index') }}">Faire un nouveau don</a>.
    </p>
    {% endif %}
    <p class="text--body text--small text--gray">
        Veuillez noter que votre reçu fiscal sera envoyé entre avril et juin, il n'est pas nécessaire de le joindre à la déclaration de revenus de mai. Une fois obtenu, conservez-le pour pouvoir le présenter en cas de contrôle de l'administration fiscale.
    </p>

    <div class="b__nudge--top-large">
        <table class="em-table">
            <thead>
            <tr>
                <th>Date</th>
                <th>Montant</th>
                <th>Type</th>
                <th>Moyen de paiement</th>
            </tr>
            </thead>
            <tbody>
            {% for donation in donations_history %}
                <tr>
                    <td>{{ donation.date|format_datetime('medium', 'none') }}</td>
                    <td>{{ donation.amountInEuros }} €</td>
                    <td>{{ donation.isSubscription ? 'Don mensuel' : 'Don ponctuel' }}</td>
                    <td>{{ ('donation.type.' ~ donation.type)|trans }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% else %}
    <div class="space--40-0 text--center">
        <p class="font-roboto text--default-large text--bold b__nudge--bottom">Soutenir La République En Marche</p>
        <a class="btn btn--red" href="{{ path('app_donation_index') }}">Je donne</a>
    </div>
{% endif %}
